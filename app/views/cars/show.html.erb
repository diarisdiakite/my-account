<div id="<%= dom_id @car %>">
  <p style="color: green"><%= notice %></p>

  <%# <%= render 'shared/backend/header_cars' %>

  <div class="container-fluid">
    <div class="row">
      <div class="col-md-2">
        <div class="view-icon">
          <% if @car.icon.attached? %>
            <%= image_tag @car.icon, class: 'img-fluid' %>
          <% end %>
          <strong><%= link_to @car.name, user_car_path(@user, @car) %></strong>
          <small>
            <%= button_to 'Delete this car', [@user, @car], method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger btn-sm', style: 'margin-right: 10px;' %>
            <%= link_to 'Edit this car', edit_user_car_path(user_id: @user.id, car_id: @car&.id), class: 'btn btn-primary btn-sm' %>
            <%= link_to 'Add a New Reservation', new_user_car_reservation_path(user_id: @user.id, car_id: @car&.id), class: 'btn btn-success btn-sm' %>
          </small>
        </div>
      </div>
      <div class="col-md-9">
        <h5 class="mb-3">Reservations</h5>
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Date</th>
              <th scope="col">Time Ago</th>
              <th scope="col">Total Amount Payable</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @car.reservations.each do |reservation| %>
              <tr>
                <td><%= link_to reservation.created_at, user_car_reservation_path(@user, @car, reservation) %></td>
                <td><%= time_ago_in_words(reservation.created_at) %></td>
                <td>$<%= reservation.total_amount_payable %></td>
                <td>
                  <% if can? :destroy, reservation %>
                    <%= button_to 'Delete', url_for([@user, @car, reservation]), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger btn-sm' %>
                    <%= link_to 'Edit', edit_user_car_reservation_path(@user, @car, reservation), class: 'btn btn-primary btn-sm' %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>

        <div class="mt-3">
          <h5>Total Payment</h5>
          <p>$<%= @car.total_reservation_amount %></p>
        </div>
      </div>
    </div>
  </div>
</div>
